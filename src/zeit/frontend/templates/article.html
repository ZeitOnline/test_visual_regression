{% extends "templates/layout.html" %}
{% import 'templates/block_elements.tpl' as blocks %}
{% block content %}
    <article class="article">
        <div class="article__wrap">
            <div class="article__head-wrap">
                <header class="article__title-wrap">
                    <div class="is-constrained is-centered">
                        <h2 class="article__supertitle">
                            {{ view.supertitle }}
                        </h2>
                        <h1 class="article__title">
                            {{view.title}}
                        </h1>
                        <div class="article__meta">
                            {{ blocks.author_date(view.publish_date | format_date('long'), view.source) }}
                        </div>
                        <div class="article__opener">
                            <span class="article__subtitle">
                                <p>{{view.subtitle}}</p>
                            </span>
                            <span class="article__meta">
                                {% if view.genre -%}
                                    <span class="article__meta__genre">{{view.genre}}</span>
                                {%- endif %}
                                {{ blocks.meta_author(view.author) }}
                                {% if view.location -%}
                                    <span class="article__meta__location">{{view.location}}</span>
                                {%- endif %}
                            </span>
                        </div>
                    </div>
                </header>
                {% if view.header_img %}
                    {{ blocks.img(view.header_img) }}
                {% endif %}

            </div>

            <div class="article__body">

                {% for page in view.pages %}
                <div class="article__page">
                    {% for item in page %}
                            {{ blocks[item|block_type](item)}}
                    {% endfor %}
                </div>
                {% endfor %}

                {% if view.rankedTags %}
                <div class="article__tags is-constrained is-centered">
                    <span class="article__tags__title">Tags</span>
                    {# XXX will be empty until zeit.connector
                       provides DAV-properties #}
                    {% for tag in view.rankedTags %}
                      <a href="#{{ tag.url_value }}">{{ tag.label }}</a>
                      {% if not loop.last %}
                          ,
                      {% endif %}
                    {% endfor %}
                </div>
                {% endif %}
                
                {{ blocks.focussed_nextread(view.focussed_nextread) }}

            </div>
        </div>
	</article>
{% endblock content %}
