{% extends "templates/layout.html" %}
{% import 'templates/block_elements.tpl' as blocks with context%}

{% macro title() -%}
  <h2 class="article__supertitle">
      {{ view.supertitle }}
  </h2>
  <h1 class="article__title">
      {{view.title}}
  </h1>
{%- endmacro %}

{% macro subtitle() -%}
  <span class="article__subtitle">
      <p>{{view.subtitle}}</p>
  </span>
{%- endmacro %}

{% macro render_page(page) %}
  {% for item in page %}
          {{ blocks[item|block_type](item)}}
  {% endfor %}
{% endmacro %}

{% block content %}
    <article class="article" id="js-article">
        <div class="article__wrap">
            <div class="article__head-wrap">
                <header class="article__title-wrap">
                    <div class="is-constrained is-centered">
                        {{ title() }}
                        <div class="article__meta">
                            {{ blocks.author_date(view.show_article_date | format_date('long'), view.source) }}
                        </div>
                        <div class="article__opener">
                            {{ subtitle() }}
                            <span class="article__meta">
                                {% if view.genre -%}
                                    <span class="article__meta__genre">{{view.genre}}</span>
                                {%- endif %}
                                {{ blocks.meta_author(view.author) }}
                                {% if view.location -%}
                                    <span class="article__meta__location">{{view.location}}</span>
                                {%- endif %}
                            </span>
                        </div>
                    </div>
                </header>
            </div>

            <div class="article__body">

                {% for page in view.pages %}
                <div class="article__page">
                    {{ render_page(page) }}
                </div>
                {% endfor %}

                {% if view.rankedTags %}
                <div class="article__tags is-constrained is-centered">
                    <span class="article__tags__title">Tags</span>
                    {% for tag in view.rankedTags %}
                      <a href="#{{ tag.url_value }}">{{ tag.label }}</a>
                      {% if not loop.last %}
                          ,
                      {% endif %}
                    {% endfor %}
                </div>
                {% endif %}

                {{ blocks.mock_comments() }}

                {{ blocks.focussed_nextread(view.focussed_nextread) }}

            </div>
        </div>
	</article>

    <!-- seo article date modification -->
    {{blocks.add_publish_date(view.date_last_published_semantic,view.date_first_released | format_date('long'))}}

{% endblock content %}
