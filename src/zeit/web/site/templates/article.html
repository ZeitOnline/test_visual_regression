{% extends "zeit.web.site:templates/content.html" %}
{% block content_ad_script -%}
{% if view.context.advertising_enabled %}
<script type="text/javascript">
    (function() {
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.async = true;
        s.src = document.location.protocol + '//cdn.iqcontentplatform.de/iq.js';
        var sc = document.getElementsByTagName('script')[0]; sc.parentNode.insertBefore(s, sc);
    })();
</script>
{% endif %}
{%- endblock %}

{% block article_heading %}
    {% if view.has_series_attached %}
        <div class="article-series">
            {% require image = get_image(view, view.series, variant_id='panorama', fallback=False) -%}
                {% set module_layout = "article-series" %}
                {% set media_caption_additional_class = 'figcaption--hidden' %}
                {% set media_block_additional_class = 'is-pixelperfect' -%}
                {% include "zeit.web.core:templates/inc/asset/image.tpl" %}
            {%- endrequire -%}

            <a href="{{ view.series | create_url }}" class="article-series__heading" itemprop="isPartOf">
                <div class="article-series__inner-heading">
                    <span class="article-series__kicker">Aus der Serie</span><span class="visually-hidden">: </span>
                    <span class="article-series__title">{{ view.serie }}</span>
                </div>
            </a>
        </div>
    {% endif %}

    {{ super() }}
{% endblock article_heading %}

{% block article_pages %}
    <section class="article-page" data-page-number="{{ view.current_page.number + 1 }}">
        {%- set page = view.current_page -%}
        {%- include "zeit.web.core:templates/inc/article/page.html" -%}
    </section>
{% endblock article_pages %}

{% block article_main_image %}
    {% if view.page_nr == 1 %}
        {% set image = view.main_image_block %}
        {% include "zeit.web.core:templates/inc/asset/image_article.tpl" %}
    {% endif %}
{% endblock article_main_image %}

{% block article_pagination %}
    {% include "zeit.web.site:templates/inc/article/pagination.tpl" %}
{% endblock article_pagination %}

{% block article_storystreamteaser %}
    {% if view.storystream %}

        {% set blockname = 'storystream-in-article' %}

        {# TODO: div or article or aside ? #}
        <aside class="{{ blockname }}">
            <div class="{{ blockname }}__container {{ blockname }}__container--header">
                <div class="{{ blockname }}__content {{ blockname }}__content--header">
                    <h2 class="{{ blockname }}__headline">
                        <span class="{{ blockname }}__headline-kicker">Im Überblick</span>
                        <span class="visually-hidden">:</span>
                        <span class="{{ blockname }}__headline-title">{{ view.storystream.title }}</span>
                    </h2>
                </div>
            </div>
            <div class="{{ blockname }}__container">
                <div class="{{ blockname }}__content">
                    <ul class="{{ blockname }}__list">
                        {% for atom in view.storystream_items %}

                            {% if atom == view.context %}
                                <li class="{{ blockname }}__listcaption {{ blockname }}__listcaption--current">Dieser Artikel</li>
                                <li class="{{ blockname }}__listitem {{ blockname }}__listitem--current">
                                    {{ atom.tldr_title }}</a>
                                </li>

                                {% if not loop.last %}
                                    <li class="{{ blockname }}__listcaption">zuvor</li>
                                {% endif %}

                            {% else %}

                                {% if loop.first %}
                                    <li class="{{ blockname }}__listcaption">danach</li>
                                {% endif %}

                                <li class="{{ blockname }}__listitem">
                                <a href="{{ atom.uniqueId | create_url }}" class="{{ blockname }}__link">{{ atom.tldr_title }}
                                </a></li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>
                <a class="button" href="{{ view.storystream.uniqueId | create_url }}">zum Überblick</a>
            </div>
        </aside>
    {% endif %}
{% endblock %}

{% block veeseo_div %}
    <div class="RA2VW2"></div>
{% endblock %}

{% block print %}
    {% include "zeit.web.core:templates/inc/article/print.tpl" %}
{% endblock %}

