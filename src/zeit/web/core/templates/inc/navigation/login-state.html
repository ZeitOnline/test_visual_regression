{% import 'zeit.web.core:templates/macros/layout_macro.tpl' as lama %}

{# because this is included via ESI request, we have no "view is framebuilder", but we can see the context-uri parameter #}
{% if user and 'framebuilder' not in request.url %}
    <a class="nav__login-title" href="{{ profile }}" role="button" aria-controls="user-menu" aria-label="Account" data-ct-label="user-menu" data-follow-mobile="true">
        {% if user.picture -%}
            <span class="nav__user-picture" style="background-image: url({{ user.picture }})"></span>
        {%- else %}
            <span class="nav__user-picture nav__user-picture--default">
                {{ lama.use_svg_icon('avatar', 'nav__user-avatar', package) }}
            </span>
        {%- endif %}

        <span class="nav__user-name">{{ user.name or user.mail | replace('@', '<span class="at-char">@</span>' | safe) }}</span>
    </a>
    <ul class="nav__login-list" id="user-menu" aria-hidden="true" data-ct-column>
        <li><a href="{{ profile }}">Konto</a></li>
        <li><a href="{{ settings('premium_host', '') }}/abo?wt_zmc=fix.int.zonpme.zede.dropdown.premium.text.link.link&utm_medium=fix&utm_source=zede_zonpme_int&utm_campaign=dropdown&utm_content=premium_text_link_link">Digital-Abo</a></li>
        <li><a href="{{ settings('community_host', '') }}/user">Kommentare</a></li>
        <li>
            <a href="{{ logout }}">
                Abmelden
                {{ lama.use_svg_icon('login', 'nav__login-icon', package) }}
            </a>
        </li>
    </ul>
{% else %}
    <a href="{{ login }}" class="nav__login-link">
        Anmelden
        <span class="nav__login-register">
            / Registrieren
            {{ lama.use_svg_icon('login', 'nav__login-icon', package) }}
        </span>
    </a>
{% endif %}

{% include "zeit.web.core:templates/inc/inline_js/rawr_sso.tpl" %}
