<script>
    // Picture element HTML5 shiv
    document.createElement( 'picture' );

    window.Zeit = {
        jsconfHost: '{{ request.jsconf_host }}',
        communityHost: '{{ request.registry.settings.community_host }}',
        view: {
            {% for key, value in view.js_vars -%}
                '{{ key }}': '{{ value | remove_break }}',
            {% endfor -%}

            {# use to get view values savely #}

            get: function( key ) {
                return this[key] ? this[key] : '';
            }
        },
        {% if view.is_wrapped -%}
        is_wrapped: true,
        wrapped: {
            client: /Android/i.test(navigator.userAgent) ? 'android' : 'ios',
            ivwclient: /Android/i.test(navigator.userAgent) ? 'aadzeion' : 'appzeion'
        },
        {% endif -%}
        tabletMinWidth: 768,
        sideAdMinWidth: 998,
        noliquidMaxWidth: 1024,
        maxWidth: 1280,
        getClientWidth: function() {
            return Math.max( document.documentElement.clientWidth || 0, window.innerWidth || 0 );
        },
        isMobileView: function() {
            return this.getClientWidth() < this.tabletMinWidth;
        },
        getSiteParam: function( text ) {
            text = text || '';
            if ( this.isMobileView() ) {
                if ( this.is_wrapped ) {
                    return 'mobile.app.' + this.wrapped.client;
                }
                return 'mobile.' + text;
            }
            return 'desktop.' + text;
        },
        {% if toggles('tracking') and settings('c1_prefix') and view.c1_client %}
        getCeleraOneOrigin: function() {
            if ( this.isMobileView() ) {
                if ( this.is_wrapped ) {
                    return 'app';
                }
                return 'mobile';
            }
            return 'web';
        },
        {% endif -%}
        viewport: {
            meta: document.getElementById('viewport-meta'),
            standard: document.getElementById('viewport-meta').getAttribute('content'),
            banner: 'width=1280',
            set: function( key ) {
                this.meta.setAttribute( 'content', this[ key ] );
            },
            isLandscape: function() {
                if ( window.matchMedia ) {
                    return window.matchMedia( '(orientation: landscape)' ).matches;
                }

                var orientation = screen.orientation || screen.mozOrientation || screen.msOrientation,
                    angle;

                if ( typeof orientation === 'string' ) {
                    return /^landscape/.test( orientation );
                }

                if ( typeof orientation === 'object' ) {
                    angle = orientation.angle;
                } else if ( 'orientation' in window ) {
                    angle = window.orientation;
                }

                return Math.abs( angle ) === 90;
            }
        },
        breakpoint: {
            get: function () {
                try {
                    return window.getComputedStyle( document.querySelector('body'), ':before' ).getPropertyValue( 'content' ).replace( /\W/g, '' ) || 'desktop'; // replace " and ' at last
                } catch( e ) {
                    return 'desktop';
                }
            },
            getTrackingBreakpoint: function() {
                var point = this.get();
                return point === 'desktop' ? 'stationaer' : point;
            }
        },
        queue: [],
        require: function() {
            this.queue.push( arguments );
        }
    };

{%- if view.context.advertising_enabled %}
    {%- if view.banner_toggles('viewport_zoom') == 'tablet' %}
    {# /* ZON style: set viewport for tablets */ #}

    if ( screen.width >= window.Zeit.tabletMinWidth && screen.width < window.Zeit.maxWidth ) {
        window.Zeit.viewport.set( 'banner' );
    }

    {%- elif view.banner_toggles('viewport_zoom') == 'tablet-landscape' %}
    {# /* ZMO style: set viewport for tablets in landscape mode */ #}

    if ( screen.width >= window.Zeit.tabletMinWidth && screen.width < window.Zeit.maxWidth && window.Zeit.viewport.isLandscape() ) {
        window.Zeit.viewport.set( 'banner' );
    }

    {%- endif %}
{%- endif %}

</script>
