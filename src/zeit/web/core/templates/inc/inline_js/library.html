<script>
    // Picture element HTML5 shiv
    document.createElement( 'picture' );
    window.Zeit = {
        publicPath: '{{ request.asset_host }}/js/',
        jsconfHost: '{{ request.jsconf_host }}',
        cookieFallbackDomain: '{{ settings('cookie_fallback_domain', 'zeit.de') }}',
        moderationURL: '{{ view.moderation_url }}',
        cpVideoPlayerId: '{{ settings('brightcove_videoplayer_hp_cp_single', '65fa926a-0fe0-4031-8cbf-9db35cecf64a') }}',
        cpVideoPlayerIdWithoutAds: '{{ settings('brightcove_videoplayer_hp_cp_single_wo_ads', 'r1xb937iwZ') }}',
        articleVideoPlayerId: '{{ settings('brightcove_videoplayer_article', 'c09a3b98-8829-47a5-b93b-c3cca8a4b5e9') }}',
        articleVideoPlayerIdWithoutAds: '{{ settings('brightcove_videoplayer_article_wo_ads', 'NykzeyfYg') }}',
        hpOverlay: {
            active: {{ 'true' if settings('hp_overlay_active', False) else 'false' }},
            interval: '{{ settings('hp_overlay_interval') }}'
        },
        overscrollingActive: {{ 'true' if settings('overscrolling_active', False) else 'false' }},
        actualHost: '{{ request.route_url('home') }}',
        view: {
            {% for key, value in view.js_vars -%}
                '{{ key }}': {{ value | tojson | safe }},
            {% endfor -%}

            {# use to get view values savely #}

            get: function( key ) {
                return this[key] ? this[key] : '';
            }
        },
        toggles: {
            {% for key, value in view.js_toggles -%}
                '{{ key }}': {{ 'true' if value else 'false' }},
            {% endfor -%}

            get: function( key ) {
                return this[key] || false;
            }
        },
        {% if view is framebuilder -%}
        isWrapped: navigator.userAgent.indexOf('ZONApp') > -1,
        {% else -%}
        isWrapped: {{ 'true' if view.is_wrapped else 'false' }},
        {% endif -%}
        wrapped: {
            client: /Android/i.test(navigator.userAgent) ? 'android' : 'ios',
            ivwclient: /Android/i.test(navigator.userAgent) ? 'aadzeion' : 'appzeion'
        },
        tabletMinWidth: 768,
        tabletSmallMinWidth: 1000,
        sideAdMinWidth: 998,
        noliquidMaxWidth: 1024,
        maxWidth: 1280,
        getClientWidth: function() {
            return Math.max( document.documentElement.clientWidth || 0, window.innerWidth || 0 );
        },
       isMobileView: function() {
            return this.getClientWidth() < this.tabletMinWidth;
        },
        getSiteParam: function() {
            if ( this.isMobileView() ) {
                if ( this.isWrapped ) {
                    return 'mobile.app.' + this.wrapped.client;
                }
                return 'mobile.site';
            }
            return 'desktop.site';
        },
        {% if toggles('tracking') and settings('c1_prefix') and view.c1_client -%}
        getCeleraOneOrigin: function() {
            if ( this.isMobileView() ) {
                if ( this.isWrapped ) {
                    return 'app';
                }
                return 'mobile';
            }
            return 'web';
        },
        {% endif -%}
        viewport: {
            meta: document.getElementById('viewport-meta'),
            standard: document.getElementById('viewport-meta').getAttribute('content'),
            banner: 'width=1280',
            portrait: 'width=1000',
            set: function( key ) {
                this.meta.setAttribute( 'content', this[ key ] );
            }
        },
        breakpoint: {
            get: function () {
                try {
                    return window.getComputedStyle( document.querySelector('body'), ':before' ).getPropertyValue( 'content' ).replace( /\W/g, '' ) || 'desktop'; // replace " and ' at last
                } catch( e ) {
                    return 'desktop';
                }
            },
            getTrackingBreakpoint: function() {
                var point = this.get();
                return point === 'desktop' ? 'stationaer' : point;
            }
        },
        queue: [],
        require: function() {
            this.queue.push( arguments );
        },
        setFontSize: function(size, updateStorage) {
            updateStorage = (typeof updateStorage !== 'undefined') ?  updateStorage : true;
            size = parseInt(size, 10);
            if (size >= 30 && size <= 300 && window.localStorage) {
                document.querySelector('html').style.fontSize = size + '%';
                if (updateStorage) window.localStorage.setItem( 'fontsize', size );
                return size;
            }
        },
        getFontSize: function() {
            if (window.localStorage) {
                var size = window.localStorage.getItem( 'fontsize' );
                size = parseInt(size, 10);
                if (size >= 30 && size <= 300) {
                    return size;
                }
            }
        }
    };

    var storedFontSize = window.Zeit.getFontSize();
    if ( storedFontSize ) {
        window.Zeit.setFontSize( storedFontSize, false );
    }

    {%- if view.advertising_enabled %}
        {%- if view.package == 'zeit.web.site' and view.is_hp %}
            {# ZON HP: inflate 768-1000 screens always to 1280px #}
            if ( screen.width >= window.Zeit.tabletMinWidth && screen.width < window.Zeit.maxWidth ) {
                window.Zeit.viewport.set( 'banner' );
            }
        {%- else %}
            {# All other pages: inflate portrait tablets (768-1000px) to 1000px #}
            if ( screen.width >= window.Zeit.tabletMinWidth && screen.width < window.Zeit.tabletSmallMinWidth ) {
                window.Zeit.viewport.set( 'portrait' );
            }
        {%- endif %}
    {%- endif %}
</script>
